# ERD와 정규화 과정

- ERD
    - DB를 구축할 때 가장 기초적인 뼈대 역할을 함
    - 릴레이션 간의 관계를 정의
- 정규화 과정
    - 릴레이션 간의 잘못된 종속 관계로 인해 DB 이상 현상이 일어나 이를 해결하기 위함
    - 저장 공간의 효율을 위해 릴레이션을 여러개로 분리하는 과정
    - 정규형 원칙을 기반으로 정규형을 만들어는 과정

---

### 정규화된 정도 ? -> 정규형으로 표현

| 정규형          | 설명                                      |
|--------------|-----------------------------------------| 
| `제1정규형`      | 테이블 내의 모든 속성값은 더 이상 분해될 수 없는 원자 값만으로 구성 | 
| `제2정규형`      | 제 1정규형이면서 부분 함수 종속을 제거한 형태              |
| `제3정규형`      | 제 2정규형이면서 이행 함수 종속을 제거한 형태              | 
| `보이스/코드 정규형` | 제 3정규형이면서 모든 결정자가 후보키인 형태               | 

---
### 제 2정규형

💡 부분 함수 종속 : 기본키 중에 특정 컬럼에만 종속되는 것

- 부분 함수 종속성을 제거하자
- 완전 함수 종속 관계로 -> 기본키의 부분집합이 결정자가 되어서는 X

| 학생번호 | 과목 | 지도교수 | 성적 |
|------|---|------|---|
| 101  | 운영체제 | A    | 100|
| 101  | DB | B    | 60|
| 102  | 자바| C    |70|
| 103  | C |D|80|
| 103  | C++ |E|90|

- 기본키를 복합키인 [학생번호, 과목] 이라고 설정하면
- [지도교수]는 [과목]만 알면 알 수 있다.
- 따라서 부분 함수 종속성을 제거하면 아래와 같이 분리할 수 있다.

| 학생번호 | 과목 | 성적 |
|------|---|-----|
| 101  | 운영체제 | 100|
| 101  | DB |  60|
| 102  | 자바| 70|
| 103  | C |80|
| 103  | C++ |90|

| 과목 | 지도교수 | 
|--|------|
|운영체제 | A    | 
|DB | B    |
|자바| C    |
|C |D|
|C++ |E|

---
### 제 3정규형

💡 이행 함수 종속 : A->B, B->C 일 때, A->C를 만족하는 것

- 이행 함수 종속성을 제거하자


| 유저ID | 등급   | 할인율 | 
|------|------|-----|
| 가    | 플래티넘 | 30% |
| 나    | 다이아  | 50% | 
| 다    | 마스터  | 70% |

- 유저ID->등급, 등급->할인율, 유저ID->할인율 을 만족한다.
- 이를 제거하면 아래와 같이 분리할 수 있다.

| 유저ID | 등급   |
|------|------|
| 가    | 플래티넘 | 
| 나    | 다이아  | 
| 다    | 마스터  | 

| 등급   | 할인율 | 
|------|-----|
| 플래티넘 | 30% |
| 다이아  | 50% | 
| 마스터  | 70% |

---

### 보이스/코드 정규형

💡 결정자 : 함수 종속 관계에서 특정 종속자를 결정짓는 요소 / 'X->Y'일 때, X는 결정자 Y는 종속자


- 모든 결정자를 후보키로 만들자

| 학생번호 | 과목   | 교수 |
|------|------|----|
| 101  | 운영체제 | A  |
| 101  | DB   | B  |
| 102  | 자바   | C  |
| 103  | DB   | B  |
| 103  | C++  | E  |

- [학생번호, 과목] 또는 [학생번호, 교수]가 후보키가 된다.
- 교수 -> 과목을 결정할 수 있지만, 
- '교수' 정보만으로는 튜플을 식별할 수 없다 (101,103 DB)

| 학생번호 | 교수 |
|------|----|
| 101  | A  |
| 101  | B  |
| 102  | C  |
| 103  | B  |
| 103  | E  |

- 밑의 릴레이션에서 교수가 후보키가 되었음

| 과목   | 교수 |
|------|---|
| 운영체제 | A |
| DB   | B |
| 자바   | C |
| C++  | E |

---

- 참고 : https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization